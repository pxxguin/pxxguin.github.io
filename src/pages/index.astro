---
import I18nKey from "../i18n/i18nKey";
import { i18n } from "../i18n/translation";
import HomeLayout from "../layouts/HomeLayout.astro";
import { getCategoryList, getSortedPosts } from "../utils/content-utils";
import { getPostUrlBySlug } from "../utils/url-utils";
import ProjectCard from "../components/ProjectCard.astro";
import { projects } from "../data/projects";
import ProjectCard from "../components/ProjectCard.astro";
import { projects } from "../data/projects";
import SkillCard from "../components/SkillCard.astro";
import { skills } from "../data/skills";
import CategoryCard from "../components/CategoryCard.astro";
import GridPostCard from "../components/GridPostCard.astro";

const categories = await getCategoryList();
const sortedPosts = await getSortedPosts();
const latestPosts = sortedPosts.slice(0, 4);

// Placeholder image URL - replace with actual image
const bgImage = "/images/hero-bg.gif";
---

<HomeLayout title={i18n(I18nKey.home)} description={i18n(I18nKey.home)}>
    <div class="relative w-full h-screen flex items-center justify-center overflow-hidden">
        <!-- Background Image -->
        <div class="absolute inset-0 z-0">
            <img src={bgImage} alt="Background" class="w-full h-full object-cover" />
            <div class="absolute inset-0 bg-black/50"></div> <!-- Overlay -->
        </div>

        <!-- Content -->
        <div class="relative z-10 text-center flex flex-col items-center gap-6 px-4">
            <!-- Pill Label -->
            <div class="inline-block px-6 py-2 rounded-full border border-white/30 bg-white/10 backdrop-blur-md text-white font-bold uppercase tracking-wider text-sm shadow-lg">
                I LOVE WHAT I DO
            </div>

            <!-- Main Heading -->
            <h1 class="text-6xl md:text-8xl font-bold text-white tracking-tight">
                Hello World !
            </h1>

            <!-- Sub Heading -->
            <!-- Sub Heading -->
            <div class="text-4xl md:text-6xl font-bold text-white">
                Let's Start with <span id="typing-text" class="text-[var(--primary)]">Web Dev</span>
            </div>

            <script>
                const words = ["Python", "C++", "C", "Java", "R", "Html", "React", "Astro", "PHP"];
                let wordIndex = 0;
                let charIndex = 0;
                let isDeleting = false;
                const typingSpeed = 150;
                const deletingSpeed = 100;
                const pauseDuration = 2000;

                function typeEffect() {
                    const heading = document.getElementById("typing-text");
                    if (!heading) return;

                    const currentWord = words[wordIndex];

                    if (isDeleting) {
                        heading.textContent = currentWord.substring(0, charIndex - 1);
                        charIndex--;
                    } else {
                        heading.textContent = currentWord.substring(0, charIndex + 1);
                        charIndex++;
                    }

                    let nextSpeed = isDeleting ? deletingSpeed : typingSpeed;

                    if (!isDeleting && charIndex === currentWord.length) {
                        isDeleting = true;
                        nextSpeed = pauseDuration;
                    } else if (isDeleting && charIndex === 0) {
                        isDeleting = false;
                        wordIndex = (wordIndex + 1) % words.length;
                        nextSpeed = 500;
                    }

                    setTimeout(typeEffect, nextSpeed);
                }

                typeEffect();
            </script>

            <!-- Quote -->
            <div class="mt-12 flex flex-col items-center gap-4 max-w-2xl">
                <div class="text-white/80 text-4xl">â</div>
                <p class="text-white/90 text-lg md:text-xl font-medium leading-relaxed">
                    ë§Œë‚˜ì„œ ë°˜ê°€ì›Œ! ë‚˜ì—ê²Œ í”„ë¡œê·¸ë˜ë° ì„¸ìƒì„ ë³´ì—¬ì¤˜ì„œ ê³ ë§ˆì›Œ
                </p>
            </div>
        </div>

        <!-- Scroll Indicator (Optional, based on common patterns) -->
        <div class="absolute bottom-10 left-1/2 -translate-x-1/2 animate-bounce">
            <div class="w-6 h-10 border-2 border-white/50 rounded-full flex justify-center pt-2">
                <div class="w-1 h-2 bg-white/50 rounded-full"></div>
            </div>
        </div>
    </div>

    <!-- Tech Stack Section -->
    <div class="max-w-[var(--page-width)] mx-auto px-4 py-8 mt-8">
        <div class="section-header text-left mb-6 opacity-0 translate-y-8 transition duration-700 ease-out">
            <h2 class="text-3xl font-bold text-black/75 dark:text-white/75 mb-2">ê¸°ìˆ  ìŠ¤íƒ ğŸ› ï¸</h2>
            <p class="text-black/50 dark:text-white/50">ì œê°€ ì£¼ë¡œ ì‚¬ìš©í•˜ëŠ” ê¸°ìˆ ë“¤ì…ë‹ˆë‹¤.</p>
        </div>

        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4">
            {skills.map((skill) => (
                <SkillCard skill={skill} />
            ))}
        </div>
    </div>

    <!-- Featured Projects Section -->
    <div class="max-w-[var(--page-width)] mx-auto px-4 py-8 mb-16">
        <div class="section-header text-left mb-6 opacity-0 translate-y-8 transition duration-700 ease-out">
            <h2 class="text-3xl font-bold text-black/75 dark:text-white/75 mb-2">ì£¼ìš” í”„ë¡œì íŠ¸ ğŸš€</h2>
            <p class="text-black/50 dark:text-white/50">ì œê°€ ì§„í–‰í•œ ì£¼ìš” í”„ë¡œì íŠ¸ë“¤ì„ ì†Œê°œí•©ë‹ˆë‹¤.</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {projects.map((project) => (
                <ProjectCard project={project} />
            ))}
        </div>
    </div>

    <!-- Category Section (Hidden) -->
    <!-- 
    <div class="max-w-[var(--page-width)] mx-auto px-4 py-8 mt-8">
        <div class="text-center mb-8">
            <h2 class="text-3xl font-bold text-black/75 dark:text-white/75 mb-2">Popular Categories ğŸ‘‘</h2>
            <p class="text-black/50 dark:text-white/50">Explore our diverse range of topics</p>
        </div>
        
        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
            {categories.map((category, index) => {
                const lowerName = category.name.toLowerCase();
                let icon = "material-symbols:folder-open-outline"; // Default icon

                if (lowerName.includes("devops") || lowerName.includes("aws")) {
                    icon = "fa6-brands:aws";
                } else if (lowerName.includes("linux")) {
                    icon = "fa6-brands:linux";
                } else if (lowerName.includes("typescript") || lowerName.includes("js")) {
                    icon = "material-symbols:javascript";
                } else if (lowerName.includes("python")) {
                    icon = "fa6-brands:python";
                } else if (lowerName.includes("react")) {
                    icon = "fa6-brands:react";
                } else if (lowerName.includes("git")) {
                    icon = "fa6-brands:git-alt";
                } else if (lowerName.includes("web") || lowerName.includes("frontend")) {
                    icon = "material-symbols:html";
                } else if (lowerName.includes("css")) {
                    icon = "fa6-brands:css3-alt";
                } else if (lowerName.includes("archive")) {
                     icon = "material-symbols:archive-outline";
                } else if (lowerName.includes("uncategorized")) {
                     icon = "material-symbols:category-outline";
                } else if (lowerName.includes("deepl") || lowerName.includes("ai") || lowerName.includes("llm")) {
                    icon = "material-symbols:robot-2-outline";
                } else if (lowerName.includes("nlp")) {
                    icon = "material-symbols:translate";
                } else if (lowerName.includes("paper")) {
                    icon = "material-symbols:article-outline";
                } else if (lowerName.includes("study") || lowerName.includes("algo")) {
                    icon = "material-symbols:menu-book-outline";
                }

                return (
                    <CategoryCard 
                        name={category.name} 
                        count={category.count} 
                        url={category.url} 
                        icon={icon}
                        index={index}
                    />
                );
            })}
        </div>
    </div>
    -->

    <!-- Useful Development Tools Section (Hidden) -->
    <!-- 
    <div class="max-w-[var(--page-width)] mx-auto px-4 py-8 mb-16">
        <div class="text-left mb-6">
            <h2 class="text-3xl font-bold text-black/75 dark:text-white/75 mb-2">ìµœê·¼ í¬ìŠ¤íŒ… â¤ï¸â€ğŸ”¥</h2>
            <p class="text-black/50 dark:text-white/50">ê°€ì¥ ìµœê·¼ì— ì‘ì„±ëœ í¬ìŠ¤íŒ…ì„ ë³¼ê¹Œìš”?</p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
             {latestPosts.slice(0, 3).map((entry) => (
                <GridPostCard
                    entry={entry}
                    title={entry.data.title}
                    tags={entry.data.tags}
                    category={entry.data.category}
                    published={entry.data.published}
                    url={getPostUrlBySlug(entry.slug)}
                    image={entry.data.image}
                    description={entry.data.description}
                    class="h-full"
                />
            ))}
        </div>
    </div>
    -->

    <script>
        const observerOptions = {
            root: null,
            rootMargin: '0px',
            threshold: 0.1
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach((entry, index) => {
                if (entry.isIntersecting) {
                    setTimeout(() => {
                        entry.target.classList.remove('opacity-0', 'translate-y-8');
                    }, index * 100); // Staggered delay
                    observer.unobserve(entry.target);
                }
            });
        }, observerOptions);

        document.querySelectorAll('.project-card, .skill-card, .section-header').forEach((card) => {
            observer.observe(card);
        });
    </script>
</HomeLayout>
